title: Detect Unquoted Service Path Creation or Modification
id: d1f3b9f2-3cfa-4e81-8f1e-9aeb3c2e4b28
description: Detects creation or modification of Windows services with unquoted executable paths containing spaces, which can lead to privilege escalation via unquoted service paths.
author: SentinelByte
date: 2025-08-15
status: experimental
references:
  - https://gtfobins.github.io/#+windows
  - https://attack.mitre.org/techniques/T1543/003/
logsource:
  product: windows
  service: security
  definition: 'Windows Security Event Log'
detection:
  selection:
    EventID: 4657
    ObjectName|contains: '\Services\'
    NewValue|contains: ' '
    NewValue|not_contains: '"'
  condition: selection
fields:
  - ObjectName
  - NewValue
falsepositives:
  - Legitimate software installers or updaters
level: medium
tags:
  - attack.persistence
  - attack.t1543
  - attack.privilege_escalation
  - attack.t1543.003